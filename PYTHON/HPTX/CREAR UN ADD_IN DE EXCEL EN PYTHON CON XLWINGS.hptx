##itemID:000
##menu-item BEGIN
CREAR UN ADD-IN DE EXCEL EN PYTHON CON XLWINGS
WEB ORIGINAL:
##menu-item END
##Contenido BEGIN
CREAR UN ADD-IN DE EXCEL EN PYTHON CON XLWINGS:
Web Original:
CREAR UN ADD-IN DE EXCEL EN PYTHON CON XLWINGS:
Generado por chatGPT

PRO-LIMP AUTOMATIZACION
+34 636832005
##Contenido END

##itemID:001
##menu-item BEGIN
Preparar Python y xlwings en tu sistema
##menu-item END
##Contenido BEGIN
Preparar Python y xlwings en tu sistema:
Para comenzar, abre el Simbolo del sistema o PowerShell en Windows. Primero verifica que tienes Python instalado escribiendo y ejecutando python --version. Luego instala xlwings en tu Python actual escribiendo y ejecutando python -m pip install --upgrade xlwings. Despues instala el add-in oficial de xlwings en Excel escribiendo y ejecutando xlwings addin install. Una vez hecho esto, cierra todas las ventanas de Excel que tengas abiertas. Abre Excel de nuevo y verifica que aparecio una pestana llamada xlwings en la cinta.
##Contenido END

##itemID:002
##menu-item BEGIN
Crear la estructura del add-in
##menu-item END
##Contenido BEGIN
Crear la estructura del add-in:
Cierra Excel otra vez, no debe quedar abierto. Vuelve a la ventana de Simbolo del sistema o PowerShell. Crea una carpeta para tu proyecto, por ejemplo mkdir C:\Users\TU_USUARIO\excel_addin_demo. Entra en la carpeta del proyecto con cd C:\Users\TU_USUARIO\excel_addin_demo. Genera el proyecto de add-in con xlwings escribiendo xlwings quickstart mi_addin --addin --ribbon. Esto crea dentro de esta carpeta al menos mi_addin.py, mi_addin.xlam y una estructura basica de add-in con pestana MyAddin en Excel.
##Contenido END

##itemID:003
##menu-item BEGIN
Abrir el add-in en Excel
##menu-item END
##Contenido BEGIN
Abrir el add-in en Excel:
En el Explorador de archivos, entra en C:\Users\TU_USUARIO\excel_addin_demo. Haz doble clic sobre mi_addin.xlam. Pulsa Habilitar contenido o Habilitar macros si Excel lo pide. Pulsa Ctrl+N o Libro en blanco para abrir un libro nuevo normal. Verifica que en la cinta de Excel aparece una pestana llamada MyAddin.
##Contenido END

##itemID:004
##menu-item BEGIN
Configurar el interprete de Python del add-in - Parte 1
##menu-item END
##Contenido BEGIN
Configurar el interprete de Python del add-in - Parte 1:
Si ya usaste xlwings addin install y ese Python es el que quieres usar, puede que ya funcione sin tocar nada. Si no, sigue estos pasos. Con mi_addin.xlam abierto, pulsa Alt + F11 para abrir el Editor de VBA. En el panel izquierdo, haz clic en ThisWorkbook dentro del proyecto que se llama algo como VBAProject (mi_addin.xlam) o myaddin. En la ventana de Propiedades, si no se ve pulsa F4, busca la propiedad IsAddin. Cambia la propiedad IsAddin de True a False. Cierra el Editor de VBA con Alt + Q.
##Contenido END

##itemID:005
##menu-item BEGIN
Configurar el interprete de Python del add-in - Parte 2
##menu-item END
##Contenido BEGIN
Configurar el interprete de Python del add-in - Parte 2:
Vuelve a Excel y localiza la nueva hoja oculta que aparece con nombre _myaddin.conf. Renombra esa hoja a myaddin.conf. En la hoja myaddin.conf, localiza la celda que corresponde a Interpreter_Win. Escribe en Interpreter_Win la ruta completa a tu pythonw.exe, por ejemplo C:\Users\TU_USUARIO\AppData\Local\Programs\Python\Python313\pythonw.exe. Guarda el archivo mi_addin.xlam desde Excel con Archivo > Guardar.
##Contenido END

##itemID:006
##menu-item BEGIN
Configurar el interprete de Python del add-in - Parte 3
##menu-item END
##Contenido BEGIN
Configurar el interprete de Python del add-in - Parte 3:
Vuelve a abrir el Editor de VBA con Alt + F11. Vuelve a seleccionar ThisWorkbook en el panel izquierdo. Cambia la propiedad IsAddin de False a True. Guarda de nuevo el proyecto desde el Editor de VBA con Archivo > Guardar mi_addin.xlam. Cierra el Editor de VBA con Alt + Q.
##Contenido END

##itemID:007
##menu-item BEGIN
Escribir el codigo Python de tu add-in
##menu-item END
##Contenido BEGIN
Escribir el codigo Python de tu add-in:
Abre tu editor preferido, por ejemplo VS Code o Notepad++. Abre el archivo C:\Users\TU_USUARIO\excel_addin_demo\mi_addin.py. Borra el contenido de ejemplo si quieres y pega este codigo minimo:

import xlwings as xw

@xw.sub
def escribir_mensaje():
    wb = xw.Book.caller()
    sht = wb.sheets[0]
    sht["A1"].value = "Hola desde el add-in de Python"

@xw.func
def doble(n):
    return n * 2

El decorador @xw.sub se usa para macros que se ejecutan desde botones de la cinta. El decorador @xw.func se usa para funciones UDF que puedes usar en celdas de Excel. Guarda el archivo mi_addin.py.
##Contenido END

##itemID:008
##menu-item BEGIN
Importar las funciones Python en el add-in
##menu-item END
##Contenido BEGIN
Importar las funciones Python en el add-in:
Vuelve a Excel con mi_addin.xlam cargado y un libro nuevo en blanco. Ve a la pestana MyAddin en la cinta de Excel. Busca el grupo User Defined Functions (UDFs) en la pestana MyAddin. En el cuadro UDF Modules escribe mi_addin sin .py, solo el nombre del modulo. Pulsa el boton Import Python UDFs en el mismo grupo de la cinta. Espera a que termine la importacion. Si hay errores, Excel mostrara un mensaje.
##Contenido END

##itemID:009
##menu-item BEGIN
Probar el add-in como funcion UDF
##menu-item END
##Contenido BEGIN
Probar el add-in como funcion UDF:
En la hoja de Excel en el libro normal, NO en mi_addin.xlam, haz clic en la celda A1. Escribe un numero, por ejemplo 5. En la celda B1 escribe la formula =doble(A1). Pulsa Enter para confirmar la formula. Verifica que en B1 aparece 10, lo que demuestra que Excel esta llamando a tu funcion Python doble.
##Contenido END

##itemID:010
##menu-item BEGIN
Probar el add-in como macro desde la cinta
##menu-item END
##Contenido BEGIN
Probar el add-in como macro desde la cinta:
Ve de nuevo a la pestana MyAddin. Pulsa el boton Run o el boton del ejemplo que venga en el ribbon, si esta enlazado a escribir_mensaje. Verifica que en la celda A1 de la hoja activa aparece Hola desde el add-in de Python.
##Contenido END

##itemID:011
##menu-item BEGIN
Instalar el add-in para que se cargue siempre
##menu-item END
##Contenido BEGIN
Instalar el add-in para que se cargue siempre:
Cierra Excel por completo, incluyendo mi_addin.xlam. Vuelve a la ventana de Simbolo del sistema o PowerShell. Entra de nuevo en la carpeta del proyecto con cd C:\Users\TU_USUARIO\excel_addin_demo. Ejecuta el comando para instalar tu add-in personalizado: xlwings addin install --file mi_addin.xlam. Abre Excel normalmente y comprueba que Excel carga mi_addin.xlam al arrancar y que la pestana MyAddin esta disponible en todos los libros.
##Contenido END

##itemID:012
##menu-item BEGIN
Uso diario del add-in
##menu-item END
##Contenido BEGIN
Uso diario del add-in:
Abre Excel normalmente, mi_addin.xlam se cargara solo. Crea o abre cualquier libro .xlsx de trabajo. Usa las formulas UDF, por ejemplo =doble(A1), como si fueran funciones nativas de Excel. Usa los botones del ribbon MyAddin para ejecutar macros Python, por ejemplo escribir_mensaje.
##Contenido END

##itemID:013
##menu-item BEGIN
VALIDACION CON FUENTES TECNICAS OFICIALES
##menu-item END
##Contenido BEGIN
VALIDACION CON FUENTES TECNICAS OFICIALES:
Para validar la informacion de este tutorial, voy a buscar las fuentes oficiales de xlwings.
##Contenido ENDAhora voy a actualizar la sección de validación con la información encontrada.

##itemID:000
##menu-item BEGIN
CREAR UN ADD-IN DE EXCEL EN PYTHON CON XLWINGS
WEB ORIGINAL:
##menu-item END
##Contenido BEGIN
CREAR UN ADD-IN DE EXCEL EN PYTHON CON XLWINGS:
Web Original:
CREAR UN ADD-IN DE EXCEL EN PYTHON CON XLWINGS:
Generado por chatGPT

PRO-LIMP AUTOMATIZACION
+34 636832005
##Contenido END

##itemID:001
##menu-item BEGIN
Preparar Python y xlwings en tu sistema
##menu-item END
##Contenido BEGIN
Preparar Python y xlwings en tu sistema:
Para comenzar, abre el Simbolo del sistema o PowerShell en Windows. Primero verifica que tienes Python instalado escribiendo y ejecutando python --version. Luego instala xlwings en tu Python actual escribiendo y ejecutando python -m pip install --upgrade xlwings. Despues instala el add-in oficial de xlwings en Excel escribiendo y ejecutando xlwings addin install. Una vez hecho esto, cierra todas las ventanas de Excel que tengas abiertas. Abre Excel de nuevo y verifica que aparecio una pestana llamada xlwings en la cinta.
##Contenido END

##itemID:002
##menu-item BEGIN
Crear la estructura del add-in
##menu-item END
##Contenido BEGIN
Crear la estructura del add-in:
Cierra Excel otra vez, no debe quedar abierto. Vuelve a la ventana de Simbolo del sistema o PowerShell. Crea una carpeta para tu proyecto, por ejemplo mkdir C:\Users\TU_USUARIO\excel_addin_demo. Entra en la carpeta del proyecto con cd C:\Users\TU_USUARIO\excel_addin_demo. Genera el proyecto de add-in con xlwings escribiendo xlwings quickstart mi_addin --addin --ribbon. Esto crea dentro de esta carpeta al menos mi_addin.py, mi_addin.xlam y una estructura basica de add-in con pestana MyAddin en Excel.
##Contenido END

##itemID:003
##menu-item BEGIN
Abrir el add-in en Excel
##menu-item END
##Contenido BEGIN
Abrir el add-in en Excel:
En el Explorador de archivos, entra en C:\Users\TU_USUARIO\excel_addin_demo. Haz doble clic sobre mi_addin.xlam. Pulsa Habilitar contenido o Habilitar macros si Excel lo pide. Pulsa Ctrl+N o Libro en blanco para abrir un libro nuevo normal. Verifica que en la cinta de Excel aparece una pestana llamada MyAddin.
##Contenido END

##itemID:004
##menu-item BEGIN
Configurar el interprete de Python del add-in - Parte 1
##menu-item END
##Contenido BEGIN
Configurar el interprete de Python del add-in - Parte 1:
Si ya usaste xlwings addin install y ese Python es el que quieres usar, puede que ya funcione sin tocar nada. Si no, sigue estos pasos. Con mi_addin.xlam abierto, pulsa Alt + F11 para abrir el Editor de VBA. En el panel izquierdo, haz clic en ThisWorkbook dentro del proyecto que se llama algo como VBAProject (mi_addin.xlam) o myaddin. En la ventana de Propiedades, si no se ve pulsa F4, busca la propiedad IsAddin. Cambia la propiedad IsAddin de True a False. Cierra el Editor de VBA con Alt + Q.
##Contenido END

##itemID:005
##menu-item BEGIN
Configurar el interprete de Python del add-in - Parte 2
##menu-item END
##Contenido BEGIN
Configurar el interprete de Python del add-in - Parte 2:
Vuelve a Excel y localiza la nueva hoja oculta que aparece con nombre _myaddin.conf. Renombra esa hoja a myaddin.conf. En la hoja myaddin.conf, localiza la celda que corresponde a Interpreter_Win. Escribe en Interpreter_Win la ruta completa a tu pythonw.exe, por ejemplo C:\Users\TU_USUARIO\AppData\Local\Programs\Python\Python313\pythonw.exe. Guarda el archivo mi_addin.xlam desde Excel con Archivo > Guardar.
##Contenido END

##itemID:006
##menu-item BEGIN
Configurar el interprete de Python del add-in - Parte 3
##menu-item END
##Contenido BEGIN
Configurar el interprete de Python del add-in - Parte 3:
Vuelve a abrir el Editor de VBA con Alt + F11. Vuelve a seleccionar ThisWorkbook en el panel izquierdo. Cambia la propiedad IsAddin de False a True. Guarda de nuevo el proyecto desde el Editor de VBA con Archivo > Guardar mi_addin.xlam. Cierra el Editor de VBA con Alt + Q.
##Contenido END

##itemID:007
##menu-item BEGIN
Escribir el codigo Python de tu add-in
##menu-item END
##Contenido BEGIN
Escribir el codigo Python de tu add-in:
Abre tu editor preferido, por ejemplo VS Code o Notepad++. Abre el archivo C:\Users\TU_USUARIO\excel_addin_demo\mi_addin.py. Borra el contenido de ejemplo si quieres y pega este codigo minimo:

import xlwings as xw

@xw.sub
def escribir_mensaje():
    wb = xw.Book.caller()
    sht = wb.sheets[0]
    sht["A1"].value = "Hola desde el add-in de Python"

@xw.func
def doble(n):
    return n * 2

El decorador @xw.sub se usa para macros que se ejecutan desde botones de la cinta. El decorador @xw.func se usa para funciones UDF que puedes usar en celdas de Excel. Guarda el archivo mi_addin.py.
##Contenido END

##itemID:008
##menu-item BEGIN
Importar las funciones Python en el add-in
##menu-item END
##Contenido BEGIN
Importar las funciones Python en el add-in:
Vuelve a Excel con mi_addin.xlam cargado y un libro nuevo en blanco. Ve a la pestana MyAddin en la cinta de Excel. Busca el grupo User Defined Functions (UDFs) en la pestana MyAddin. En el cuadro UDF Modules escribe mi_addin sin .py, solo el nombre del modulo. Pulsa el boton Import Python UDFs en el mismo grupo de la cinta. Espera a que termine la importacion. Si hay errores, Excel mostrara un mensaje.
##Contenido END

##itemID:009
##menu-item BEGIN
Probar el add-in como funcion UDF
##menu-item END
##Contenido BEGIN
Probar el add-in como funcion UDF:
En la hoja de Excel en el libro normal, NO en mi_addin.xlam, haz clic en la celda A1. Escribe un numero, por ejemplo 5. En la celda B1 escribe la formula =doble(A1). Pulsa Enter para confirmar la formula. Verifica que en B1 aparece 10, lo que demuestra que Excel esta llamando a tu funcion Python doble.
##Contenido END

##itemID:010
##menu-item BEGIN
Probar el add-in como macro desde la cinta
##menu-item END
##Contenido BEGIN
Probar el add-in como macro desde la cinta:
Ve de nuevo a la pestana MyAddin. Pulsa el boton Run o el boton del ejemplo que venga en el ribbon, si esta enlazado a escribir_mensaje. Verifica que en la celda A1 de la hoja activa aparece Hola desde el add-in de Python.
##Contenido END

##itemID:011
##menu-item BEGIN
Instalar el add-in para que se cargue siempre
##menu-item END
##Contenido BEGIN
Instalar el add-in para que se cargue siempre:
Cierra Excel por completo, incluyendo mi_addin.xlam. Vuelve a la ventana de Simbolo del sistema o PowerShell. Entra de nuevo en la carpeta del proyecto con cd C:\Users\TU_USUARIO\excel_addin_demo. Ejecuta el comando para instalar tu add-in personalizado: xlwings addin install --file mi_addin.xlam. Abre Excel normalmente y comprueba que Excel carga mi_addin.xlam al arrancar y que la pestana MyAddin esta disponible en todos los libros.
##Contenido END

##itemID:012
##menu-item BEGIN
Uso diario del add-in
##menu-item END
##Contenido BEGIN
Uso diario del add-in:
Abre Excel normalmente, mi_addin.xlam se cargara solo. Crea o abre cualquier libro .xlsx de trabajo. Usa las formulas UDF, por ejemplo =doble(A1), como si fueran funciones nativas de Excel. Usa los botones del ribbon MyAddin para ejecutar macros Python, por ejemplo escribir_mensaje.
##Contenido END

##itemID:013
##menu-item BEGIN
VALIDACION CON FUENTES TECNICAS OFICIALES
##menu-item END
##Contenido BEGIN
VALIDACION CON FUENTES TECNICAS OFICIALES:

Los pasos descritos en este tutorial estan validados con la documentacion oficial de xlwings. A continuacion se presentan los puntos tecnicos confirmados y las fuentes oficiales de referencia.

Puntos tecnicos validados:

xlwings es una biblioteca Python con licencia BSD que permite llamar a Python desde Excel e interactuar con Excel desde Python. Soporta macros, funciones definidas por usuario UDF y automatizacion con una sintaxis cercana a VBA.

El comando xlwings quickstart crea automaticamente un proyecto con un archivo de Excel y un archivo Python listos para usar. El comando quickstart crea una hoja de configuracion llamada _xlwings.conf que debe renombrarse quitando el guion bajo para activarla.

Para crear un add-in personalizado con ribbon, se usa el comando quickstart con las banderas --addin y --ribbon, lo que genera una estructura basica con pestana personalizada en Excel. Para activar la configuracion del add-in, se debe cambiar la propiedad IsAddin a False temporalmente, renombrar la hoja _myaddin.conf a myaddin.conf, configurar el interprete Python en Interpreter_Win o Interpreter_Mac, y luego cambiar IsAddin de vuelta a True.

El decorador @xw.func se usa para crear funciones definidas por usuario UDF que se importan a Excel, mientras que el decorador @xw.sub se usa para crear macros que se pueden ejecutar desde botones. Para importar las funciones UDF en Excel, se usa el boton Import Python UDFs en la pestana del add-in, especificando el nombre del modulo Python sin la extension .py.

El comando xlwings addin install copia el add-in al directorio XLSTART de Excel, y puede usar la bandera --file para instalar un add-in personalizado especifico.

Fuentes oficiales de referencia:

Documentacion oficial de xlwings:
https://docs.xlwings.org/

Documentacion sobre Custom Add-ins:
https://docs.xlwings.org/en/stable/customaddin.html

Documentacion sobre User Defined Functions UDF:
https://docs.xlwings.org/en/stable/udfs.html

Documentacion sobre Command Line Client:
https://docs.xlwings.org/en/stable/command_line.html

Repositorio oficial en GitHub:
https://github.com/xlwings/xlwings

Pagina de PyPI del paquete xlwings:
https://pypi.org/project/xlwings/

Sitio web oficial de xlwings:
https://www.xlwings.org/

Estas fuentes confirman que los procedimientos descritos en el tutorial son los metodos oficialmente recomendados para crear add-ins personalizados de Excel con Python usando xlwings.


CREAR UN ADD-IN DE EXCEL EN PYTHON CON XLWINGS
Generado por chatGPT
PRO-LIMP AUTOMATIZACION
+34 636832005
##Contenido END