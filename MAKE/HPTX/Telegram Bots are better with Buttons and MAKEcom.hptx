##itemID:000
##menu-item BEGIN
Telegram Bots are better with Buttons and MAKEcom
WEB ORIGINAL:
##menu-item END
##Contenido BEGIN
Telegram Bots are better with Buttons and MAKEcom:
Web Original:
Telegram Bots are better with Buttons and MAKEcom:
https://youtu.be/IFoM81ZASfs?si=TqrO4RrrkpzUFhdB

PRO-LIMP AUTOMATIZACION
+34 636832005
##Contenido END

##itemID:001
##menu-item BEGIN
Introducción: Por qué usar botones
##menu-item END
##Contenido BEGIN
Introducción: Por qué usar botones:
El objetivo principal de este tutorial es mejorar los chatbots en plataformas como Telegram o Slack añadiendo interactividad mediante botones. Los botones hacen que sea mucho más fácil para las personas interactuar con el bot, ya que no tienen que escribir comandos complicados, logrando una experiencia más amigable.

Vamos a construir un "bot de tareas". El funcionamiento es sencillo: el usuario dice o escribe lo que necesita, el bot le ofrece un botón para confirmar la tarea, el usuario lo pulsa, el bot crea la tarea en tu sistema y finalmente actualiza el mensaje para confirmar que todo se ha hecho correctamente.
##Contenido END

##itemID:002
##menu-item BEGIN
Configuración inicial en Make.com
##menu-item END
##Contenido BEGIN
Configuración inicial en Make.com:
Para crear este bot, utilizaremos un flujo de trabajo (escenario) en Make.com dividido en tres secciones o filas:

La fila superior se encarga de los mensajes de voz: recibe el audio y lo convierte a texto usando herramientas de inteligencia artificial.

La fila central se encarga de los mensajes de texto normal.

La fila inferior es especial y se encarga de manejar lo que sucede cuando se pulsa el botón.

Es fundamental que, sin importar si el usuario envía voz o texto, el bot envíe una respuesta de vuelta con la transcripción (lo que entendió) para confirmar que la información es correcta antes de ofrecer el botón.
##Contenido END

##itemID:003
##menu-item BEGIN
Cómo añadir el botón al mensaje
##menu-item END
##Contenido BEGIN
Cómo añadir el botón al mensaje:
Para que el bot muestre un botón junto con su respuesta, debes configurar el módulo de Telegram en Make.com. Dentro de la configuración avanzada de este módulo, busca la función llamada "reply markup" (marcado de respuesta).[1]

Esta función es la que te permite definir los botones.[2][3] Al crear el botón, es obligatorio asignarle un valor llamado "callback data" (datos de devolución de llamada). Por ejemplo, puedes ponerle el valor "create task". Este dato es crucial porque es la información oculta que el botón enviará de vuelta a Make.com cuando el usuario lo presione, permitiendo al sistema saber qué acción ejecutar.
##Contenido END

##itemID:004
##menu-item BEGIN
Cómo funciona la pulsación del botón
##menu-item END
##Contenido BEGIN
Cómo funciona la pulsación del botón:
Cuando un usuario pulsa el botón en Telegram, Make.com lo recibe como una interacción nueva. Para que el escenario sepa que se trata de un botón y no de un mensaje normal, debe buscar la presencia de una "callback query" (consulta de devolución de llamada).[4]

Si el escenario detecta que existe un "callback query ID", significa que se pulsó un botón y el flujo debe seguir por el camino inferior (la tercera fila que configuramos). Esta consulta contiene dos datos vitales: el mensaje original que el bot envió y el dato del botón que configuramos antes (por ejemplo, "create task").
##Contenido END

##itemID:005
##menu-item BEGIN
Guardar el contexto con Data Store
##menu-item END
##Contenido BEGIN
Guardar el contexto con Data Store:
Cuando se pulsa el botón, el bot inicia una ejecución nueva y, por defecto, "olvida" lo que el usuario había escrito originalmente. Para solucionar esto, usamos el "Data Store" de Make.com, que actúa como una memoria o base de datos simple.[5]

En el Data Store guardamos cuatro cosas: el ID del chat, el ID del mensaje del bot, el ID del mensaje del usuario y el texto original del usuario.

Para poder recuperar esta información después, creamos una clave única combinando el ID del chat y el ID del mensaje del bot (ejemplo: chatID//botMessageID). Cuando el usuario pulsa el botón, el bot usa esa misma combinación para buscar en la base de datos y recuperar el texto original (como "necesito comprar pastel") para procesar la tarea.
##Contenido END

##itemID:006
##menu-item BEGIN
Mejorar la experiencia del usuario
##menu-item END
##Contenido BEGIN
Mejorar la experiencia del usuario:
Para evitar problemas, es importante que el usuario no pueda pulsar el mismo botón varias veces. La solución es hacer que el botón desaparezca una vez que se ha pulsado.

Esto se logra utilizando la función de editar mensaje del módulo de Telegram. El bot modifica su propio mensaje anterior manteniendo el mismo texto, pero dejando vacía la configuración de "reply markup". Al hacer esto, el botón se borra visualmente del chat y el usuario ya no puede volver a hacer clic en él.
##Contenido END

##itemID:007
##menu-item BEGIN
Procesar la tarea con Inteligencia Artificial
##menu-item END
##Contenido BEGIN
Procesar la tarea con Inteligencia Artificial:
Una vez que el bot ha recuperado el texto original del usuario desde el Data Store, utiliza inteligencia artificial (como el módulo Grok en modo JSON) para entender qué debe hacer.

Se usa una técnica llamada "few-shot prompt", que consiste en darle a la IA un ejemplo de instrucciones para entrenarla. Le pedimos que analice el texto y extraiga un título para la tarea y una lista de elementos pendientes (to-do items). La IA debe entregar esta información en un formato estructurado (JSON) para que el sistema pueda leerlo sin errores.
##Contenido END

##itemID:008
##menu-item BEGIN
Creación y confirmación de la tarea
##menu-item END
##Contenido BEGIN
Creación y confirmación de la tarea:
Con el título y el contenido listos, el bot envía la información a tu sistema de gestión de tareas favorito (como Notion, ClickUp u otros). Ten en cuenta que para asignar la tarea a una persona específica, podrías necesitar un paso extra para conectar el ID de usuario de Telegram con el ID de usuario de tu sistema de tareas.

Finalmente, el bot actualiza el mensaje original una última vez. Ahora cambia el texto para incluir un enlace directo a la tarea recién creada. Para que el enlace se vea profesional y funcione bien, se utiliza sintaxis Markdown en la configuración del mensaje.
##Contenido END

##itemID:009
##menu-item BEGIN
VALIDACIÓN CON FUENTES TÉCNICAS OFICIALES
##menu-item END
##Contenido BEGIN
VALIDACIÓN CON FUENTES TÉCNICAS OFICIALES:
He realizado una búsqueda técnica para validar los conceptos explicados en el tutorial utilizando la documentación oficial de Telegram Bot API y Make.com.

Puntos técnicos validados:

Botones Interactivos (Inline Keyboards):
La documentación de Telegram confirma que los botones que realizan acciones dentro del mismo chat se llaman "Inline Keyboard Buttons". Estos botones utilizan el campo "callback_data" para enviar información oculta al bot sin que el usuario tenga que escribir nada.
Fuente: https://core.telegram.org/bots/api#inlinekeyboardbutton

Mecanismo de Respuesta (Callback Query):
Se confirma que cuando se pulsa un botón inline, Telegram envía un objeto llamado "CallbackQuery". Este objeto contiene un "id" único, el objeto "message" original y el "data" (la información configurada en el botón), tal como se describe en el tutorial.
Fuente: https://core.telegram.org/bots/api#callbackquery

Módulos de Make.com (Data Store y Telegram):
Make.com posee módulos nativos para "Data Store" que permiten las acciones "Get a record" (Obtener registro) y "Add/Replace a record" (Añadir/Reemplazar registro) mediante el uso de claves (Keys), validando la estrategia de almacenamiento de contexto explicada. También valida el uso del módulo Telegram para "Edit Message Text" como método para eliminar botones.
Fuente: https://www.make.com/en/help/tools/data-store
Fuente: https://www.make.com/en/integrations/telegram-bot


Sources
help
make.com
aiogram.dev
python-telegram-bot.org
aiogram.dev
youtube.com
geeksforgeeks.org
medium.com
gramio.dev
readthedocs.io
Google Search Suggestions
Display of Search Suggestions is required when using Grounding with Google Search. Learn more
Telegram Bot API inline keyboard buttons
Telegram Bot API callback query documentation
Make.com Data Store module documentation
Make.com Telegram module reply markup documentation
##Contenido END