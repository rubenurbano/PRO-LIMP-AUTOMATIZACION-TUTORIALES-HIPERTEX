##itemID:000
##menu-item BEGIN
Parte 1_Gestión de Citas con Appsheet y Google Calendar
WEB ORIGINAL:
##menu-item END
##Contenido BEGIN
Parte 1_Gestión de Citas con Appsheet y Google Calendar:
Web Original:
Parte 1_Gestión de Citas con Appsheet y Google Calendar:
https://youtu.be/pxeL0_rAhMM?si=BX27QQLMkFgRlmIE
##Contenido END

##itemID:001
##menu-item BEGIN
Introducción: AppSheet y Google Calendar
##menu-item END
##Contenido BEGIN
Introducción: AppSheet y Google Calendar:
Este tutorial te guiará paso a paso para crear una aplicación que organiza tu agenda diaria utilizando dos herramientas principales:[1][2][3][4][5][6][7][8][9][10]

AppSheet: Funciona como una herramienta que transforma tu hoja de cálculo en una aplicación funcional.

Google Calendar: Actúa como tu agenda digital donde se reflejarán las citas.
##Contenido END

##itemID:002
##menu-item BEGIN
Paso 1: Preparación de la Hoja de Cálculo (Horarios)
##menu-item END
##Contenido BEGIN
Paso 1: Preparación de la Hoja de Cálculo (Horarios):
El primer paso es preparar la base de datos en Google Sheets:

Abre una hoja de cálculo nueva y nómbrala "agenda programada".

Crea una primera tabla llamada "horarios".

En esta tabla, añade los siguientes encabezados o campos:

ID

inicio

fin

Rellena la tabla con los rangos de tiempo disponibles. En el ejemplo del tutorial, se crean 10 citas de una hora de duración cada una, comenzando a las 8:00 AM y terminando a las 6:00 PM.
##Contenido END

##itemID:003
##menu-item BEGIN
Paso 2: Creación de la Tabla de Citas Diarias
##menu-item END
##Contenido BEGIN
Paso 2: Creación de la Tabla de Citas Diarias:
Dentro de la misma hoja de cálculo ("agenda programada"), debes crear una segunda tabla:

Nombra esta tabla "citas diarias".

Define los campos necesarios para gestionar las citas:

ID

título

descripción

invitados

ID de Google calendar

Es un requisito importante que el campo "ID de Google calendar" coincida exactamente con el "Row ID" (Identificador de Fila) para que la sincronización funcione correctamente.
##Contenido END

##itemID:004
##menu-item BEGIN
Paso 3: Configuración Inicial en AppSheet y Conexión
##menu-item END
##Contenido BEGIN
Paso 3: Configuración Inicial en AppSheet y Conexión:
Ahora debes configurar la aplicación en AppSheet:

Ve a AppSheet y crea una nueva aplicación.[5]

Debes conectar la aplicación a Google Calendar.[1][7] Para esto, genera una nueva fuente de datos (Data source) seleccionando "Google calendar" y otorga los permisos necesarios.[7]

Selecciona el calendario de citas que ya tengas creado.[7]

Realiza una prueba inicial: crea una cita manual (ej. "prueba número uno") desde la app para confirmar que aparece en tu Google Calendar y verifica que al borrarla en la app, también se borra del calendario.
##Contenido END

##itemID:005
##menu-item BEGIN
Paso 4: Añadir Tablas y Configurar Datos
##menu-item END
##Contenido BEGIN
Paso 4: Añadir Tablas y Configurar Datos:
Incorpora la información de tu hoja de cálculo a la aplicación:

Añade la tabla "horarios" a AppSheet y crea una vista tipo tabla para ella.

Añade la tabla "citas diarias" a AppSheet y crea su vista tipo tabla correspondiente.

Configura los tipos de datos en la tabla "citas diarias":

Campos obligatorios: título, invitados e ID de Google calendar.

Campo "invitados": Cambia el tipo a "List" (para permitir varios correos separados por comas).

Campo "ID Google calendar": Cambia el tipo a "ref" (referencia) y selecciona que apunte a la tabla "citas".
##Contenido END

##itemID:006
##menu-item BEGIN
Paso 5: Automatización para Generar Horarios Diarios
##menu-item END
##Contenido BEGIN
Paso 5: Automatización para Generar Horarios Diarios:
Para evitar crear los horarios manualmente cada día, configuraremos un "Bot" (robot):

Crea un nuevo Bot en AppSheet.[3][5][8]

Configura un evento programado para que se ejecute diariamente (por ejemplo, a las 6:00 AM, antes de que empiece la jornada).

Configura el proceso para que lea cada registro de la tabla "horarios" y ejecute una acción.

La acción debe ser "insertar un nuevo registro" en la tabla "citas diarias" con estos valores:

Título: "sin asignar" (para indicar que está libre).

Start (Inicio): Usa una fórmula que combine la función "today" (fecha actual) con la hora de inicio de la tabla horarios.

Fin (Final): Usa una fórmula similar combinando "today" con la hora de fin.
##Contenido END

##itemID:007
##menu-item BEGIN
Paso 6: Corrección de Zona Horaria
##menu-item END
##Contenido BEGIN
Paso 6: Corrección de Zona Horaria:
Si notas que las citas se crean con horas incorrectas, sigue estos pasos:

Verifica la configuración de zona horaria en AppSheet (por ejemplo, puede estar en GMT 00).

Verifica la zona horaria de tu hoja de cálculo (por ejemplo, GMT-6).

Ajusta la configuración en AppSheet para que coincida con la de la hoja de cálculo.

Elimina los registros erróneos y vuelve a ejecutar el Bot para validar que las horas ahora sean correctas.
##Contenido END

##itemID:008
##menu-item BEGIN
Paso 7: Mejoras Visuales (Columna Virtual)
##menu-item END
##Contenido BEGIN
Paso 7: Mejoras Visuales (Columna Virtual):
Para mejorar cómo se ven los horarios en la aplicación:

Crea una columna virtual (existe solo en la app, no en la hoja de cálculo) llamada "horario".

Usa la función "text" sobre los campos Start y Fin para extraer solo la hora y minutos, y concaténalos.

Configura esta columna "horario" como la etiqueta (label) de la tabla para que sea lo que el usuario ve al seleccionar una opción.
##Contenido END

##itemID:009
##menu-item BEGIN
Paso 8: Ordenar los Horarios
##menu-item END
##Contenido BEGIN
Paso 8: Ordenar los Horarios:
Para que los horarios aparezcan en orden cronológico:

Ve al campo "ID Google calendar" en la tabla "citas diarias".

En la opción "Valores sugeridos", introduce una fórmula usando la función "SELECT".

Esta función debe extraer los datos de las citas de hoy ("today") y ordenarlas ascendentemente usando el campo "Start". Esto asegurará que la lista desplegable muestre las horas ordenadas (8:00, 9:00, etc.).
##Contenido END

##itemID:010
##menu-item BEGIN
Paso 9: Bot de Asignación y Actualización
##menu-item END
##Contenido BEGIN
Paso 9: Bot de Asignación y Actualización:
Ahora configuraremos qué pasa cuando alguien reserva una cita:

Renombra el primer Bot (el generador de horarios).

Crea un segundo Bot llamado "inicio asignación".

Configura este Bot para que se active cuando se inserte un nuevo registro en la tabla "citas diarias".

Crea una acción llamada "actualización cita" destinada a actualizar la cita en Google Calendar.

Los campos a actualizar en el calendario son: descripción, invitados y título.

Usa la función "lookup" para buscar estos datos en la tabla "citas diarias" usando el "ID Google calendar" y asignarlos al evento del calendario.
##Contenido END

##itemID:011
##menu-item BEGIN
Paso 10: Filtrar Horarios Ya Asignados
##menu-item END
##Contenido BEGIN
Paso 10: Filtrar Horarios Ya Asignados:
Para evitar que alguien reserve una hora que ya está ocupada:

Regresa al campo "ID Google calendar" en la tabla "citas diarias".

En "Valores sugeridos", modifica la fórmula para incluir un filtro "AND" con dos condiciones:

Que sean registros de hoy.

Que NO exista ya una asignación para ese horario (usando "COUNT" igual a cero).

Esto hará que, al reservar una hora (ej. 8:00 a 9:00), esa opción desaparezca de la lista para los siguientes usuarios.
##Contenido END

##itemID:012
##menu-item BEGIN
Paso 11: Envío de Correo Electrónico
##menu-item END
##Contenido BEGIN
Paso 11: Envío de Correo Electrónico:
El paso final es notificar a los invitados:

En el proceso "actualizar Google calendar" del Bot de asignación, añade un paso final.

Configura el envío de un correo electrónico tipo "Custom" (Personalizado).[3][5]

Selecciona la tabla "citas diarias".

En el cuerpo del correo, incluye el título, la descripción y el enlace de la reunión.

El enlace se obtiene de la columna "me link" que AppSheet genera automáticamente.

Realiza una prueba final (ej. "prueba número tres") para confirmar que llega el correo con todos los datos correctos.
##Contenido END

##itemID:013
##menu-item BEGIN
VALIDACIÓN CON FUENTES TÉCNICAS OFICIALES
##menu-item END
##Contenido BEGIN
VALIDACIÓN CON FUENTES TÉCNICAS OFICIALES:

He validado los puntos técnicos clave de este tutorial mediante la documentación oficial de Google AppSheet y Google Calendar:

Conexión con Google Calendar:
Se confirma que AppSheet permite añadir Google Calendar como una fuente de datos ("Data Source"). AppSheet trata el calendario como una tabla donde los eventos son filas con columnas predeterminadas (Título, Inicio, Fin, Descripción, etc.).
Referencia: Documentación de AppSheet sobre "Use data from Google Calendar".[11]

Automatización (Bots):
La creación de Bots con eventos programados (Scheduled Events) es una función nativa. Se valida que se pueden configurar procesos diarios (Daily) a una hora específica para ejecutar tareas sobre una tabla.[5]
Referencia: Ayuda de AppSheet sobre "Trigger bots with scheduled events".

Uso de Funciones (SELECT, LOOKUP, TODAY):
Las fórmulas mencionadas en el tutorial son estándar en AppSheet:

TODAY(): Devuelve la fecha actual.[12]

SELECT(): Se utiliza para filtrar listas de valores basándose en condiciones (como filtrar horarios disponibles).

LOOKUP(): Validada como función para recuperar el valor de una columna específica usando una clave de referencia (usado aquí para actualizar el calendario).
Referencia: Lista de funciones de AppSheet (Function List).[12][13]

Envío de Correos:
La tarea "Send an email" dentro de un Bot es correcta. Se confirma que se puede personalizar el cuerpo del correo e incluir datos dinámicos de las columnas de la tabla asociada.
Referencia: Documentación sobre "Send an email from an automation".[3][5][14][15]


Sources
help
zapier.com
google.dev
youtube.com
google.com
youtube.com
google.com
youtube.com
google.com
google.com
google.com
cdata.com
google.com
google.com
google.com
google.com
Google Search Suggestions
Display of Search Suggestions is required when using Grounding with Google Search. Learn more
AppSheet Send an email from an automation bot
AppSheet documentation connect Google Calendar data source
AppSheet automation bots schedule daily event
AppSheet function SELECT LOOKUP TODAY
##Contenido END